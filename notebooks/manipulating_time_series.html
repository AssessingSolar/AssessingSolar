
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Manipulating Time-series &#8212; Solar Resource Assessment in Python</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.e8f53015daec13862f6db5e763c41738.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Overview" href="solar_resource_data_overview.html" />
    <link rel="prev" title="Solar Radiation Modelling" href="solar_radiation_modeling.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/assessing_solar_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Solar Resource Assessment in Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Solar Resource Assessment in Python
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Solar radiation modeling
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="solar_components_and_geometry.html">
   Solar Components and Geometry
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="solar_position.html">
   Solar position
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="solar_radiation_modeling.html">
   Solar Radiation Modelling
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Manipulating Time-series
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Solar resource data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="solar_resource_data_overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="satellite_data.html">
   Satellite data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reanalysis_data.html">
   Reanalysis data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ground_measurements.html">
   Ground-based solar irradiance data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="quality_asessment.html">
   Quality assessment of solar irradiance data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="benchmarking.html">
   Benchmarking
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Solar power modeling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="solar_power_modeling.html">
   Solar Power Modelling
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/manipulating_time_series.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/AssessingSolar/Assessing-Solar"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/AssessingSolar/Assessing-Solar/issues/new?title=Issue%20on%20page%20%2Fnotebooks/manipulating_time_series.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/AssessingSolar/Assessing-Solar/master?urlpath=tree/notebooks/manipulating_time_series.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#time-series-handling-a-id-timeseries-handling-a">
   1 Time-series handling
   <a id="timeseries_handling">
   </a>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#build-our-customized-dataset">
     1.1 Build our customized dataset
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-series-when-timestamps-are-available">
     1.2 Time-series when timestamps are available:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-series-when-date-and-time-are-available">
     1.3 Time-series when date and time are available:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-series-when-the-time-data-is-split-in-multiple-columns">
     1.4 Time-series when the time data is split in multiple columns:
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#time-series-when-the-timestamp-is-given-as-epoch-unix-time">
     1.5 Time-series when the timestamp is given as epoch (Unix Time)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#down-and-up-sampling-time-series-data-a-id-timeseries-downup-sampling-a">
   2 Down and up-sampling time-series data
   <a id="timeseries_downup_sampling">
   </a>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#method-asfreq-vs-resample">
     2.1 Method ‘asfreq’ vs. ‘resample’
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#down-sampling-the-data-in-a-time-series">
     2.2 Down-sampling the data in a time-series
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#producing-hourly-average-irradiance-from-minutely-observations">
       Producing hourly average irradiance from minutely observations
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#producing-time-series-of-monthly-total-ghi-dhi-dni-irradiation-from-minutely-observations">
       Producing time-series of monthly total GHI, DHI, DNI irradiation from minutely observations
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#up-sampling-the-data-in-a-time-series">
     2.3 Up-sampling the data in a time-series
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#producing-half-hourly-irradiance-series-from-hourly-observations">
       Producing half-hourly irradiance series from hourly observations
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interpolating-time-series-data-a-id-timeseries-interpolation-a">
   3 Interpolating time-series data
   <a id="timeseries_interpolation">
   </a>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualizing-time-series-data-a-id-timeseries-visualization-a">
   4 Visualizing time-series data
   <a id="timeseries_visualization">
   </a>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-a-time-series-for-a-day-of-interest">
     4.1 Plotting a time-series for a day of interest
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-a-time-series-for-a-few-consecutive-days-of-interest">
     4.2 Plotting a time-series for a few consecutive days of interest
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-a-time-series-for-a-few-non-consecutive-days-of-interest">
     4.3 Plotting a time-series for a few non-consecutive days of interest
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#daily-insolation-throughout-the-year">
     4.4 Daily insolation throughout the year
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-summary">
   Section summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references-a-id-references-a">
   References
   <a id="references">
   </a>
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="manipulating-time-series">
<h1>Manipulating Time-series<a class="headerlink" href="#manipulating-time-series" title="Permalink to this headline">¶</a></h1>
<p>Time-series are a key element when assessing solar resource data. In this section, we present several examples to learn how to deal with different formats in the data and few common tasks to prepare our time-series for later analysis, such as down and up-sampling data when we need different temporal resolution than that initially available or interpolating missing values in the data.</p>
<p>The dataset used in the examples of this section is a customized dataset using solar radiation measurements from the Measurement and Instrumentation Data Center (MIDC) of the U.S. National Renewable Energy Laboratory (NREL). The station selected is located at the University of Nevada - Las Vegas (UNLV) and the data used are 1-minute GHI, DHI and DNI measurements for the year 2020 (Andreas and Stoffel, 2006).</p>
<p>In this section, we cover: <br></p>
<ul class="simple">
<li><p><a class="reference external" href="#timeseries_handling">1 Time-series handling</a> <br></p></li>
<li><p><a class="reference external" href="#timeseries_downup_sampling">2 Down and up-sampling time-series data</a> <br></p></li>
<li><p><a class="reference external" href="#timeseries_interpolation">3 Interpolating time-series data</a> <br></p></li>
<li><p><a class="reference external" href="#timeseries_visualization">4 Visualizating time-series data</a></p></li>
</ul>
<hr class="docutils" />
<div style="text-align: right"> <i>Content by Javier Lopez Lorente</i> </div><div class="section" id="time-series-handling-a-id-timeseries-handling-a">
<h2>1 Time-series handling <a id='timeseries_handling'></a><a class="headerlink" href="#time-series-handling-a-id-timeseries-handling-a" title="Permalink to this headline">¶</a></h2>
<p>Datasets often come in different formats depending on the source. Those formats sometimes cannot be used straightaway to build a time-series and may require additional processing steps before building the time-series. For example:  <br></p>
<ul class="simple">
<li><p><strong>What if date and time are in different columns?</strong> <br></p></li>
<li><p><strong>What if the year, month, day and time are in separate columns?</strong> <br></p></li>
<li><p><strong>How to the define the timestamp format for a particular dataset?</strong> <br></p></li>
<li><p><strong>How to deal with timestamp issues, local vs. universal (UTC) time?</strong></p></li>
</ul>
<p>This subsection presents several examples to deal with different formats in which time-series data could come and shows how to build a time-series or <em>datetime series</em>, as known in Python, for later analysis. The processing steps to build time-series are based on <a class="reference external" href="https://pandas.pydata.org/">pandas library</a>.</p>
<p>Let’s get started!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importing the needed libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">pvlib</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ipykernel_1784</span><span class="o">/</span><span class="mf">691303087.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">import</span> <span class="nn">pvlib</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;seaborn&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="build-our-customized-dataset">
<h3>1.1 Build our customized dataset<a class="headerlink" href="#build-our-customized-dataset" title="Permalink to this headline">¶</a></h3>
<p>In order to build the customized dataset for this section, we make use of the I/O tools of the Python library <em>pvlib</em> to retrieve the data from the UNLV station in the MIDC. Data from other stations from the MIDC can be also retrieved using this method by adapting the station ID in the query. The different station IDs are available in the <a class="reference external" href="https://midcdmz.nrel.gov/apps/data_api_doc.pl?_idtextlist">MIDC raw data page</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Dictionary to rename certain variables from the raw data</span>
<span class="n">var_map</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Global Horiz [W/m^2]&#39;</span><span class="p">:</span> <span class="s1">&#39;ghi&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Direct Normal [W/m^2]&#39;</span><span class="p">:</span><span class="s1">&#39;dni&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Diffuse Horiz (calc) [W/m^2]&#39;</span><span class="p">:</span><span class="s1">&#39;dhi&#39;</span><span class="p">,</span>
           <span class="s1">&#39;Year&#39;</span><span class="p">:</span><span class="s1">&#39;year&#39;</span><span class="p">}</span>

<span class="c1"># Retrieving the raw data from the station </span>
<span class="n">df_ref</span> <span class="o">=</span> <span class="n">pvlib</span><span class="o">.</span><span class="n">iotools</span><span class="o">.</span><span class="n">read_midc_raw_data_from_nrel</span><span class="p">(</span><span class="s1">&#39;UNLV&#39;</span><span class="p">,</span>                     <span class="c1"># Station id</span>
                                                    <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;20200101&#39;</span><span class="p">),</span>   <span class="c1"># Start date YYYYMMDD</span>
                                                    <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s1">&#39;20201231&#39;</span><span class="p">),</span>   <span class="c1"># End date  YYYYMMDD</span>
                                                    <span class="n">variable_map</span><span class="o">=</span><span class="n">var_map</span><span class="p">)</span>       <span class="c1"># Variable Map</span>
<span class="c1"># Let&#39;s have a look to the first 2 rows of the dataset</span>
<span class="n">df_ref</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>year</th>
      <th>DOY</th>
      <th>PST</th>
      <th>dni</th>
      <th>ghi</th>
      <th>Global UVA [W/m^2]</th>
      <th>Global UVE [W/m^2]</th>
      <th>Global UVE [Index]</th>
      <th>Dry Bulb Temp [deg C]</th>
      <th>...</th>
      <th>Avg Wind Direction @ 30ft [deg from N]</th>
      <th>Peak Wind Speed @ 30ft [m/s]</th>
      <th>UVSAET Temp [deg C]</th>
      <th>Logger Temp [deg C]</th>
      <th>Logger Battery [VDC]</th>
      <th>Wind Chill Temp [deg C]</th>
      <th>dhi</th>
      <th>Zenith Angle [degrees]</th>
      <th>Azimuth Angle [degrees]</th>
      <th>Airmass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>0</td>
      <td>2020</td>
      <td>1</td>
      <td>0</td>
      <td>-1.67051</td>
      <td>-2.53035</td>
      <td>-0.005</td>
      <td>0.0</td>
      <td>0.002</td>
      <td>6.004</td>
      <td>...</td>
      <td>17.67</td>
      <td>0.098</td>
      <td>24.9</td>
      <td>22.25</td>
      <td>13.28</td>
      <td>6.004</td>
      <td>0.0</td>
      <td>166.494</td>
      <td>16.4003</td>
      <td>-7999.0</td>
    </tr>
    <tr>
      <th>2020-01-01 00:01:00-08:00</th>
      <td>0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>-1.64962</td>
      <td>-2.53035</td>
      <td>-0.007</td>
      <td>0.0</td>
      <td>0.003</td>
      <td>6.210</td>
      <td>...</td>
      <td>8.79</td>
      <td>1.176</td>
      <td>24.9</td>
      <td>22.26</td>
      <td>13.28</td>
      <td>6.210</td>
      <td>0.0</td>
      <td>166.435</td>
      <td>17.3510</td>
      <td>-7999.0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 21 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s have a look to the last 2 rows of the dataset</span>
<span class="n">df_ref</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>year</th>
      <th>DOY</th>
      <th>PST</th>
      <th>dni</th>
      <th>ghi</th>
      <th>Global UVA [W/m^2]</th>
      <th>Global UVE [W/m^2]</th>
      <th>Global UVE [Index]</th>
      <th>Dry Bulb Temp [deg C]</th>
      <th>...</th>
      <th>Avg Wind Direction @ 30ft [deg from N]</th>
      <th>Peak Wind Speed @ 30ft [m/s]</th>
      <th>UVSAET Temp [deg C]</th>
      <th>Logger Temp [deg C]</th>
      <th>Logger Battery [VDC]</th>
      <th>Wind Chill Temp [deg C]</th>
      <th>dhi</th>
      <th>Zenith Angle [degrees]</th>
      <th>Azimuth Angle [degrees]</th>
      <th>Airmass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-12-31 23:58:00-08:00</th>
      <td>0</td>
      <td>2020</td>
      <td>366</td>
      <td>2358</td>
      <td>0.000000</td>
      <td>-3.09366</td>
      <td>-0.016</td>
      <td>0.0</td>
      <td>0.003</td>
      <td>10.45</td>
      <td>...</td>
      <td>4.834</td>
      <td>7.546</td>
      <td>24.75</td>
      <td>18.97</td>
      <td>13.34</td>
      <td>8.06</td>
      <td>0.0</td>
      <td>166.558</td>
      <td>14.0772</td>
      <td>-7999.0</td>
    </tr>
    <tr>
      <th>2020-12-31 23:59:00-08:00</th>
      <td>0</td>
      <td>2020</td>
      <td>366</td>
      <td>2359</td>
      <td>0.473466</td>
      <td>-3.09367</td>
      <td>-0.015</td>
      <td>0.0</td>
      <td>0.003</td>
      <td>10.46</td>
      <td>...</td>
      <td>7.997</td>
      <td>6.664</td>
      <td>24.81</td>
      <td>18.97</td>
      <td>13.35</td>
      <td>8.24</td>
      <td>0.0</td>
      <td>166.507</td>
      <td>15.0409</td>
      <td>-7999.0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 21 columns</p>
</div></div></div>
</div>
<p>The dataset is 1-minute resolution data with 21 variables related to meteorological and other relevant data: ambient temperature, wind speed, wind direction, global horizontal irradiance (GHI), direct normal irradiance (DNI), diffuse horizontal irradiance (DHI), zenith and azimuth angles, airmass, among other.</p>
<p>For the examples in this section we will use GHI, DNI and DHI measurements and time-related data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Slice desired variables out of the 21 variables provided in the raw data. </span>
<span class="n">df_ref</span> <span class="o">=</span> <span class="n">df_ref</span><span class="p">[[</span><span class="s1">&#39;ghi&#39;</span><span class="p">,</span> <span class="s1">&#39;dni&#39;</span><span class="p">,</span> <span class="s1">&#39;dhi&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">]]</span>

<span class="c1"># Add multiple temporal data to the dataset</span>
<span class="n">df_ref</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span>
<span class="n">df_ref</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">day</span>
<span class="n">df_ref</span><span class="p">[</span><span class="s1">&#39;hour&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">hour</span>
<span class="n">df_ref</span><span class="p">[</span><span class="s1">&#39;minute&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">minute</span>
<span class="n">df_ref</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">df_ref</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%H:%M:%S&#39;</span><span class="p">)</span>
<span class="n">df_ref</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S%z&#39;</span><span class="p">)</span>

<span class="c1"># Epoch format</span>
<span class="n">df_ref</span><span class="p">[</span><span class="s1">&#39;epoch&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span><span class="o">//</span><span class="mf">1e9</span>

<span class="c1"># Reset the Index of the DataFrame</span>
<span class="n">df_ref</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Let&#39;s have a look to the resulting columns of the dataset</span>
<span class="n">df_ref</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;ghi&#39;, &#39;dni&#39;, &#39;dhi&#39;, &#39;year&#39;, &#39;month&#39;, &#39;day&#39;, &#39;hour&#39;, &#39;minute&#39;, &#39;date&#39;,
       &#39;time&#39;, &#39;timestamp&#39;, &#39;epoch&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Let’s visualize the first rows of the <strong>customized reference dataframe:</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># First 3 rows in the dataframe</span>
<span class="n">df_ref</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dni</th>
      <th>dhi</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
      <th>minute</th>
      <th>date</th>
      <th>time</th>
      <th>timestamp</th>
      <th>epoch</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-2.53035</td>
      <td>-1.670510</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2020-01-01</td>
      <td>00:00:00</td>
      <td>2020-01-01 00:00:00-0800</td>
      <td>1577865600</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-2.53035</td>
      <td>-1.649620</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2020-01-01</td>
      <td>00:01:00</td>
      <td>2020-01-01 00:01:00-0800</td>
      <td>1577865660</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-2.53035</td>
      <td>-0.856135</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>2020-01-01</td>
      <td>00:02:00</td>
      <td>2020-01-01 00:02:00-0800</td>
      <td>1577865720</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now that we have our customized reference dataset of 1-minute irradiance measurements for 2020 and temporal data, we can start building the timeseries in different ways.</p>
</div>
<div class="section" id="time-series-when-timestamps-are-available">
<h3>1.2 Time-series when timestamps are available:<a class="headerlink" href="#time-series-when-timestamps-are-available" title="Permalink to this headline">¶</a></h3>
<p>When timestamps are available, the most straightforward way to build the DataFrame with a datetime index is to convert the column with the timestamp into datetime format and set it as index.</p>
<p>Let’s see how!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A new dataframe copy of the reference dataset</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># Convert the timestamp string into datetime format </span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S%z&#39;</span><span class="p">)</span>
<span class="c1"># Set timestamp column as index</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp&#39;</span><span class="p">])</span>
<span class="c1"># See the first 3 rows of the DataFrame with Datetime Index</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dni</th>
      <th>dhi</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
      <th>minute</th>
      <th>date</th>
      <th>time</th>
      <th>timestamp</th>
      <th>epoch</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.53035</td>
      <td>-1.670510</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2020-01-01</td>
      <td>00:00:00</td>
      <td>2020-01-01 00:00:00-08:00</td>
      <td>1577865600</td>
    </tr>
    <tr>
      <th>2020-01-01 00:01:00-08:00</th>
      <td>-2.53035</td>
      <td>-1.649620</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2020-01-01</td>
      <td>00:01:00</td>
      <td>2020-01-01 00:01:00-08:00</td>
      <td>1577865660</td>
    </tr>
    <tr>
      <th>2020-01-01 00:02:00-08:00</th>
      <td>-2.53035</td>
      <td>-0.856135</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>2020-01-01</td>
      <td>00:02:00</td>
      <td>2020-01-01 00:02:00-08:00</td>
      <td>1577865720</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The format of the timestamp is specified in the argument ‘format’ as a string and can be adapted to any case. The available options in Python can be checked in this <a class="reference external" href="https://strftime.org/">link</a>.</p>
<p>Universal Time Coordinated (UTC) is usually the timestamp provided for many solar radiation data networks and platforms like the BSRN, PVGIS, etc. However, data can be also reported in local time like in our example. Timestamps can be converted to other timezones with the funcion <em>tz_convert</em>, which can be useful when dealing with data from different databases and locations worldwide:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add UTC timestamp from the local time (Pacific Summer Time)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;timestamp_utc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="s1">&#39;UTC&#39;</span><span class="p">)</span>
<span class="c1"># See the first 3 rows </span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dni</th>
      <th>dhi</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
      <th>minute</th>
      <th>date</th>
      <th>time</th>
      <th>timestamp</th>
      <th>epoch</th>
      <th>timestamp_utc</th>
    </tr>
    <tr>
      <th>timestamp</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.53035</td>
      <td>-1.670510</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2020-01-01</td>
      <td>00:00:00</td>
      <td>2020-01-01 00:00:00-08:00</td>
      <td>1577865600</td>
      <td>2020-01-01 08:00:00+00:00</td>
    </tr>
    <tr>
      <th>2020-01-01 00:01:00-08:00</th>
      <td>-2.53035</td>
      <td>-1.649620</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2020-01-01</td>
      <td>00:01:00</td>
      <td>2020-01-01 00:01:00-08:00</td>
      <td>1577865660</td>
      <td>2020-01-01 08:01:00+00:00</td>
    </tr>
    <tr>
      <th>2020-01-01 00:02:00-08:00</th>
      <td>-2.53035</td>
      <td>-0.856135</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>2020-01-01</td>
      <td>00:02:00</td>
      <td>2020-01-01 00:02:00-08:00</td>
      <td>1577865720</td>
      <td>2020-01-01 08:02:00+00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The valid timezone strings for other timezones can be found in this <a class="reference external" href="https://pvlib-python.readthedocs.io/en/stable/timetimezones.html">link</a>. When the timezone is not provided as part of the timestamp, the function <em>tz_localize</em> can be used to localize the values in a timezone-naive series. <em>tz_localize</em> will be used in the next example.</p>
</div>
<div class="section" id="time-series-when-date-and-time-are-available">
<h3>1.3 Time-series when date and time are available:<a class="headerlink" href="#time-series-when-date-and-time-are-available" title="Permalink to this headline">¶</a></h3>
<p>When date and time are available in separate columns, a timestamp can be created in a new column and the new column can then be set as index and localized. Let’s have a look how to do that:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A new dataframe copy of the reference dataset</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># New column with the date and time </span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;T&#39;</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
<span class="c1"># Convert the new column into datetime format </span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">T%H:%M:%S&#39;</span><span class="p">)</span>
<span class="c1"># Set the column &#39;datetime&#39; as index and localize it to its timezone</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s1">&#39;Etc/GMT+8&#39;</span><span class="p">)</span>
<span class="c1"># See the first 3 rows </span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dni</th>
      <th>dhi</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
      <th>minute</th>
      <th>date</th>
      <th>time</th>
      <th>timestamp</th>
      <th>epoch</th>
      <th>datetime</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.53035</td>
      <td>-1.670510</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2020-01-01</td>
      <td>00:00:00</td>
      <td>2020-01-01 00:00:00-0800</td>
      <td>1577865600</td>
      <td>2020-01-01 00:00:00</td>
    </tr>
    <tr>
      <th>2020-01-01 00:01:00-08:00</th>
      <td>-2.53035</td>
      <td>-1.649620</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2020-01-01</td>
      <td>00:01:00</td>
      <td>2020-01-01 00:01:00-0800</td>
      <td>1577865660</td>
      <td>2020-01-01 00:01:00</td>
    </tr>
    <tr>
      <th>2020-01-01 00:02:00-08:00</th>
      <td>-2.53035</td>
      <td>-0.856135</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>2020-01-01</td>
      <td>00:02:00</td>
      <td>2020-01-01 00:02:00-0800</td>
      <td>1577865720</td>
      <td>2020-01-01 00:02:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="time-series-when-the-time-data-is-split-in-multiple-columns">
<h3>1.4 Time-series when the time data is split in multiple columns:<a class="headerlink" href="#time-series-when-the-time-data-is-split-in-multiple-columns" title="Permalink to this headline">¶</a></h3>
<p>If time-related data are split across multiple columns, a timestamp can be created in a new column similarly than in the previous case. Let’s imagine our dataset would have the year, month, day, hour, and minute in separate columns. In that case, we could build our time-series as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A new dataframe copy of the reference dataset</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># Let&#39;s reduce the code lines and define the new string within the &#39;to_datetime&#39; function</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;hour&#39;</span><span class="p">,</span> <span class="s1">&#39;minute&#39;</span><span class="p">]],</span> 
                                <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">%H:%M&#39;</span><span class="p">)</span>
<span class="c1"># Set the column &#39;datetime&#39; as index</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">])</span> 
<span class="c1"># Localize the datetime series</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="s1">&#39;Etc/GMT+8&#39;</span><span class="p">)</span> 
<span class="c1"># See the first 3 rows </span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dni</th>
      <th>dhi</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
      <th>minute</th>
      <th>date</th>
      <th>time</th>
      <th>timestamp</th>
      <th>epoch</th>
      <th>datetime</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.53035</td>
      <td>-1.670510</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2020-01-01</td>
      <td>00:00:00</td>
      <td>2020-01-01 00:00:00-0800</td>
      <td>1577865600</td>
      <td>2020-01-01 00:00:00</td>
    </tr>
    <tr>
      <th>2020-01-01 00:01:00-08:00</th>
      <td>-2.53035</td>
      <td>-1.649620</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2020-01-01</td>
      <td>00:01:00</td>
      <td>2020-01-01 00:01:00-0800</td>
      <td>1577865660</td>
      <td>2020-01-01 00:01:00</td>
    </tr>
    <tr>
      <th>2020-01-01 00:02:00-08:00</th>
      <td>-2.53035</td>
      <td>-0.856135</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>2020-01-01</td>
      <td>00:02:00</td>
      <td>2020-01-01 00:02:00-0800</td>
      <td>1577865720</td>
      <td>2020-01-01 00:02:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="time-series-when-the-timestamp-is-given-as-epoch-unix-time">
<h3>1.5 Time-series when the timestamp is given as epoch (Unix Time)<a class="headerlink" href="#time-series-when-the-timestamp-is-given-as-epoch-unix-time" title="Permalink to this headline">¶</a></h3>
<p>If the dataset has epoch timestamps, note that the data will have UTC time. However, it can be converted to any timezone using the function <em>tz_convert</em>. If there are epoch timestamps, a datetime series can be formed as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># A new dataframe copy of the reference dataset</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_ref</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="c1"># Convert epoch timestamps to datetime format and localize</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;epoch&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">,</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># Set datetime as index and convert UTC time to local time</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">tz_convert</span><span class="p">(</span><span class="s1">&#39;Etc/GMT+8&#39;</span><span class="p">)</span>
<span class="c1"># See the results</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dni</th>
      <th>dhi</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
      <th>hour</th>
      <th>minute</th>
      <th>date</th>
      <th>time</th>
      <th>timestamp</th>
      <th>epoch</th>
      <th>datetime</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.53035</td>
      <td>-1.670510</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>2020-01-01</td>
      <td>00:00:00</td>
      <td>2020-01-01 00:00:00-0800</td>
      <td>1577865600</td>
      <td>2020-01-01 08:00:00+00:00</td>
    </tr>
    <tr>
      <th>2020-01-01 00:01:00-08:00</th>
      <td>-2.53035</td>
      <td>-1.649620</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>2020-01-01</td>
      <td>00:01:00</td>
      <td>2020-01-01 00:01:00-0800</td>
      <td>1577865660</td>
      <td>2020-01-01 08:01:00+00:00</td>
    </tr>
    <tr>
      <th>2020-01-01 00:02:00-08:00</th>
      <td>-2.53035</td>
      <td>-0.856135</td>
      <td>0.0</td>
      <td>2020</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>2020-01-01</td>
      <td>00:02:00</td>
      <td>2020-01-01 00:02:00-0800</td>
      <td>1577865720</td>
      <td>2020-01-01 08:02:00+00:00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We have seen how the same DataFrame with <em>datetimeindex</em> can be obtained in multiple ways depending on the format of time data provided.</p>
</div>
</div>
<hr class="docutils" />
<div class="section" id="down-and-up-sampling-time-series-data-a-id-timeseries-downup-sampling-a">
<h2>2 Down and up-sampling time-series data<a id='timeseries_downup_sampling'></a><a class="headerlink" href="#down-and-up-sampling-time-series-data-a-id-timeseries-downup-sampling-a" title="Permalink to this headline">¶</a></h2>
<p>When assessing solar resource, you may need a different time-resolution than your data for a particular part of the analysis. In those cases, it is possible to <strong>down-sample and up-sample the data at different temporal resolutions</strong> using two different methods within <a class="reference external" href="https://pandas.pydata.org/">pandas library</a> called <em>resample</em> and <em>asfreq</em>. Depending on your needs, you will opt for one or the other. Regardless of the method, both of them require a DataFrame with <em>datetimeindex</em> either time-aware (localized) or time-naive (not localized).</p>
<div class="section" id="method-asfreq-vs-resample">
<h3>2.1 Method ‘asfreq’ vs. ‘resample’<a class="headerlink" href="#method-asfreq-vs-resample" title="Permalink to this headline">¶</a></h3>
<p>Let’s first create a new DataFrame with only the columns with solar data and see the differences between both methods with examples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># New DataFrame with 1-minute data and solar data</span>
<span class="n">df_1min</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;ghi&#39;</span><span class="p">,</span> <span class="s1">&#39;dhi&#39;</span><span class="p">,</span> <span class="s1">&#39;dni&#39;</span><span class="p">]]</span>
<span class="c1"># See our new DataFrame</span>
<span class="n">df_1min</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dhi</th>
      <th>dni</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.53035</td>
      <td>0.0</td>
      <td>-1.670510</td>
    </tr>
    <tr>
      <th>2020-01-01 00:01:00-08:00</th>
      <td>-2.53035</td>
      <td>0.0</td>
      <td>-1.649620</td>
    </tr>
    <tr>
      <th>2020-01-01 00:02:00-08:00</th>
      <td>-2.53035</td>
      <td>0.0</td>
      <td>-0.856135</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s try to obtain a DataFrame down-sampled with the maximum monthly data with both methods and see the differences. With <em>asfreq</em>, it would be the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_1min</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s2">&quot;1M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ghi   -2.529330
dhi    0.000000
dni   -0.834868
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>With <em>resample</em> the result would be:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_1min</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dhi</th>
      <th>dni</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-31 00:00:00-08:00</th>
      <td>802.383</td>
      <td>386.083</td>
      <td>972.789</td>
    </tr>
    <tr>
      <th>2020-02-29 00:00:00-08:00</th>
      <td>956.928</td>
      <td>582.715</td>
      <td>1024.650</td>
    </tr>
    <tr>
      <th>2020-03-31 00:00:00-08:00</th>
      <td>1237.910</td>
      <td>632.961</td>
      <td>1011.700</td>
    </tr>
    <tr>
      <th>2020-04-30 00:00:00-08:00</th>
      <td>1370.180</td>
      <td>705.203</td>
      <td>999.360</td>
    </tr>
    <tr>
      <th>2020-05-31 00:00:00-08:00</th>
      <td>1253.240</td>
      <td>590.468</td>
      <td>983.210</td>
    </tr>
    <tr>
      <th>2020-06-30 00:00:00-08:00</th>
      <td>1340.240</td>
      <td>943.659</td>
      <td>999.233</td>
    </tr>
    <tr>
      <th>2020-07-31 00:00:00-08:00</th>
      <td>1260.490</td>
      <td>1056.520</td>
      <td>1015.320</td>
    </tr>
    <tr>
      <th>2020-08-31 00:00:00-08:00</th>
      <td>1114.410</td>
      <td>659.908</td>
      <td>1010.130</td>
    </tr>
    <tr>
      <th>2020-09-30 00:00:00-08:00</th>
      <td>1081.750</td>
      <td>670.886</td>
      <td>959.591</td>
    </tr>
    <tr>
      <th>2020-10-31 00:00:00-08:00</th>
      <td>1047.400</td>
      <td>895.895</td>
      <td>2758.840</td>
    </tr>
    <tr>
      <th>2020-11-30 00:00:00-08:00</th>
      <td>902.913</td>
      <td>411.350</td>
      <td>973.702</td>
    </tr>
    <tr>
      <th>2020-12-31 00:00:00-08:00</th>
      <td>793.258</td>
      <td>393.958</td>
      <td>985.791</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>It is obvious that the outputs are not the same and that is because the methods work differently. <em>asfreq</em> takes the value at the simultaneous stamps given by the frequency argument. See below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_1min</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s2">&quot;1M&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dhi</th>
      <th>dni</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-31 00:00:00-08:00</th>
      <td>-3.65348</td>
      <td>0.0</td>
      <td>-1.669830</td>
    </tr>
    <tr>
      <th>2020-02-29 00:00:00-08:00</th>
      <td>-3.09137</td>
      <td>0.0</td>
      <td>-1.669820</td>
    </tr>
    <tr>
      <th>2020-03-31 00:00:00-08:00</th>
      <td>-2.52933</td>
      <td>0.0</td>
      <td>-0.834917</td>
    </tr>
    <tr>
      <th>2020-04-30 00:00:00-08:00</th>
      <td>-3.61963</td>
      <td>0.0</td>
      <td>-1.669340</td>
    </tr>
    <tr>
      <th>2020-05-31 00:00:00-08:00</th>
      <td>-3.22207</td>
      <td>0.0</td>
      <td>-1.669590</td>
    </tr>
    <tr>
      <th>2020-06-30 00:00:00-08:00</th>
      <td>-3.65326</td>
      <td>0.0</td>
      <td>-0.834868</td>
    </tr>
    <tr>
      <th>2020-07-31 00:00:00-08:00</th>
      <td>-4.21426</td>
      <td>0.0</td>
      <td>-1.857120</td>
    </tr>
    <tr>
      <th>2020-08-31 00:00:00-08:00</th>
      <td>-5.14251</td>
      <td>0.0</td>
      <td>-1.620990</td>
    </tr>
    <tr>
      <th>2020-09-30 00:00:00-08:00</th>
      <td>-4.21555</td>
      <td>0.0</td>
      <td>-1.690710</td>
    </tr>
    <tr>
      <th>2020-10-31 00:00:00-08:00</th>
      <td>-3.65348</td>
      <td>0.0</td>
      <td>-1.669830</td>
    </tr>
    <tr>
      <th>2020-11-30 00:00:00-08:00</th>
      <td>-3.09265</td>
      <td>0.0</td>
      <td>-1.670510</td>
    </tr>
    <tr>
      <th>2020-12-31 00:00:00-08:00</th>
      <td>-2.53110</td>
      <td>0.0</td>
      <td>-1.176670</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Then <em>.max()</em> has returned the maximum of each of the columns.</p>
<p>In contrast, <em>resample</em> does return the maximum value within the period of time at the specified frequency. <em>resample</em> method requires a mathematical operation to perform in the resampled data (the maximum value in our case). Otherwise, it would return a <em>DatetimeIndexResampler</em> object without showing any data. See below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_1min</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1M&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.resample.DatetimeIndexResampler object at 0x00000213CAB87C18&gt;
</pre></div>
</div>
</div>
</div>
<p>The <em>resample</em> method accepts multiple <strong>mathematical and statistical operations</strong>. For example: maximum (max), minimum (min), arithmetic mean (mean), standard deviation (std), median (median), mode (mode), addition (sum), among others.</p>
<p>Both methods allow for multiple <strong>frequencies options</strong>, the available frequency tags within Python can be found <a class="reference external" href="https://stackoverflow.com/questions/35339139/where-is-the-documentation-on-pandas-freq-tags">here</a>.</p>
</div>
<div class="section" id="down-sampling-the-data-in-a-time-series">
<h3>2.2 Down-sampling the data in a time-series<a class="headerlink" href="#down-sampling-the-data-in-a-time-series" title="Permalink to this headline">¶</a></h3>
<p>Down-sampling permits turning more frequent values into less frequent. In the context of solar resource and considering our 1-minute resolution dataset, down-sampling can be used for:</p>
<ul class="simple">
<li><p>Producing a timeseries of hourly/daily average irradiance.</p></li>
<li><p>Producing a timeseries of maximum daily irradiance.</p></li>
<li><p>Estimating the hourly/daily/monthly sums of irradiation.</p></li>
<li><p>And many more!</p></li>
</ul>
<p>Let’s implement some of these listed examples!</p>
<div class="section" id="producing-hourly-average-irradiance-from-minutely-observations">
<h4>Producing hourly average irradiance from minutely observations<a class="headerlink" href="#producing-hourly-average-irradiance-from-minutely-observations" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Resampling to hourly mean values</span>
<span class="n">df_hourly</span> <span class="o">=</span> <span class="n">df_1min</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1H&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="c1"># Showing the shape of the new DataFrame</span>
<span class="n">df_hourly</span><span class="o">.</span><span class="n">shape</span> <span class="c1"># returns Rows, Columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(8784, 3)
</pre></div>
</div>
</div>
</div>
<p>There are 8760 hours in a year. Yet, we can have a look to the first few rows of the DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_hourly</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dhi</th>
      <th>dni</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.576505</td>
      <td>0.000000</td>
      <td>-0.764837</td>
    </tr>
    <tr>
      <th>2020-01-01 01:00:00-08:00</th>
      <td>-2.508561</td>
      <td>0.000000</td>
      <td>-0.631080</td>
    </tr>
    <tr>
      <th>2020-01-01 02:00:00-08:00</th>
      <td>-1.943371</td>
      <td>0.000000</td>
      <td>-0.374704</td>
    </tr>
    <tr>
      <th>2020-01-01 03:00:00-08:00</th>
      <td>-2.023108</td>
      <td>0.000000</td>
      <td>-0.379228</td>
    </tr>
    <tr>
      <th>2020-01-01 04:00:00-08:00</th>
      <td>-1.683542</td>
      <td>0.000000</td>
      <td>-0.013457</td>
    </tr>
    <tr>
      <th>2020-01-01 05:00:00-08:00</th>
      <td>-1.891827</td>
      <td>0.000000</td>
      <td>-0.006960</td>
    </tr>
    <tr>
      <th>2020-01-01 06:00:00-08:00</th>
      <td>0.116990</td>
      <td>0.351740</td>
      <td>1.146154</td>
    </tr>
    <tr>
      <th>2020-01-01 07:00:00-08:00</th>
      <td>42.787289</td>
      <td>42.289485</td>
      <td>3.388552</td>
    </tr>
    <tr>
      <th>2020-01-01 08:00:00-08:00</th>
      <td>128.938495</td>
      <td>114.490610</td>
      <td>50.297509</td>
    </tr>
    <tr>
      <th>2020-01-01 09:00:00-08:00</th>
      <td>303.623558</td>
      <td>163.197578</td>
      <td>371.458155</td>
    </tr>
    <tr>
      <th>2020-01-01 10:00:00-08:00</th>
      <td>327.718433</td>
      <td>248.435667</td>
      <td>171.612487</td>
    </tr>
    <tr>
      <th>2020-01-01 11:00:00-08:00</th>
      <td>345.318217</td>
      <td>304.172200</td>
      <td>80.353128</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A time-series with the maximum irradiance would be similar replacing <em>‘mean()’</em> with <em>‘max()’</em>.</p>
</div>
<div class="section" id="producing-time-series-of-monthly-total-ghi-dhi-dni-irradiation-from-minutely-observations">
<h4>Producing time-series of monthly total GHI, DHI, DNI irradiation from minutely observations<a class="headerlink" href="#producing-time-series-of-monthly-total-ghi-dhi-dni-irradiation-from-minutely-observations" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Resampling to monthly aggregated values</span>
<span class="n">monthly_energy</span> <span class="o">=</span> <span class="n">df_1min</span><span class="p">[[</span><span class="s1">&#39;ghi&#39;</span><span class="p">,</span> <span class="s1">&#39;dhi&#39;</span><span class="p">,</span> <span class="s1">&#39;dni&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1M&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="p">)</span>
<span class="c1"># See the results expressed in kWh·sqm</span>
<span class="n">monthly_energy</span><span class="o">/</span><span class="mi">1000</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dhi</th>
      <th>dni</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-31 00:00:00-08:00</th>
      <td>100.817440</td>
      <td>29.251020</td>
      <td>175.754908</td>
    </tr>
    <tr>
      <th>2020-02-29 00:00:00-08:00</th>
      <td>129.220507</td>
      <td>30.514029</td>
      <td>206.374110</td>
    </tr>
    <tr>
      <th>2020-03-31 00:00:00-08:00</th>
      <td>164.224723</td>
      <td>59.140048</td>
      <td>179.448458</td>
    </tr>
    <tr>
      <th>2020-04-30 00:00:00-08:00</th>
      <td>200.459859</td>
      <td>59.307923</td>
      <td>217.186189</td>
    </tr>
    <tr>
      <th>2020-05-31 00:00:00-08:00</th>
      <td>255.336215</td>
      <td>54.922454</td>
      <td>294.929842</td>
    </tr>
    <tr>
      <th>2020-06-30 00:00:00-08:00</th>
      <td>254.262295</td>
      <td>62.085767</td>
      <td>277.856782</td>
    </tr>
    <tr>
      <th>2020-07-31 00:00:00-08:00</th>
      <td>257.105784</td>
      <td>48.821531</td>
      <td>305.900237</td>
    </tr>
    <tr>
      <th>2020-08-31 00:00:00-08:00</th>
      <td>223.419662</td>
      <td>56.213721</td>
      <td>251.208590</td>
    </tr>
    <tr>
      <th>2020-09-30 00:00:00-08:00</th>
      <td>181.248566</td>
      <td>58.956766</td>
      <td>199.959672</td>
    </tr>
    <tr>
      <th>2020-10-31 00:00:00-08:00</th>
      <td>153.368877</td>
      <td>51.432641</td>
      <td>195.650044</td>
    </tr>
    <tr>
      <th>2020-11-30 00:00:00-08:00</th>
      <td>105.726263</td>
      <td>25.099434</td>
      <td>190.355946</td>
    </tr>
    <tr>
      <th>2020-12-31 00:00:00-08:00</th>
      <td>88.972596</td>
      <td>25.698295</td>
      <td>165.691623</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>It could be done in similar way for other resolutions (e.g. daily or annual irradiation).</p>
</div>
</div>
<div class="section" id="up-sampling-the-data-in-a-time-series">
<h3>2.3 Up-sampling the data in a time-series<a class="headerlink" href="#up-sampling-the-data-in-a-time-series" title="Permalink to this headline">¶</a></h3>
<p>Up-sampling permits obtaining more frequent values from less frequent. For solar data, depending on the application up to sub-minutely data could be required and up-sampling is a technique that provides a manner to increase the temporal resolution to adapt it to our needs. For example, turning an hourly time-series into a half-hourly. Let’s see an example using both <em>resample</em> and <em>asfreq</em>.</p>
<div class="section" id="producing-half-hourly-irradiance-series-from-hourly-observations">
<h4>Producing half-hourly irradiance series from hourly observations<a class="headerlink" href="#producing-half-hourly-irradiance-series-from-hourly-observations" title="Permalink to this headline">¶</a></h4>
<p>Using the DataFrame <em>df_hourly</em> created previously, it can be up-sample as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using &#39;resample&#39; method:</span>
<span class="n">df_hourly</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;30Min&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dhi</th>
      <th>dni</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.576505</td>
      <td>0.0</td>
      <td>-0.764837</td>
    </tr>
    <tr>
      <th>2020-01-01 00:30:00-08:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-01-01 01:00:00-08:00</th>
      <td>-2.508561</td>
      <td>0.0</td>
      <td>-0.631080</td>
    </tr>
    <tr>
      <th>2020-01-01 01:30:00-08:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-01-01 02:00:00-08:00</th>
      <td>-1.943371</td>
      <td>0.0</td>
      <td>-0.374704</td>
    </tr>
    <tr>
      <th>2020-01-01 02:30:00-08:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-01-01 03:00:00-08:00</th>
      <td>-2.023108</td>
      <td>0.0</td>
      <td>-0.379228</td>
    </tr>
    <tr>
      <th>2020-01-01 03:30:00-08:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-01-01 04:00:00-08:00</th>
      <td>-1.683542</td>
      <td>0.0</td>
      <td>-0.013457</td>
    </tr>
    <tr>
      <th>2020-01-01 04:30:00-08:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using &#39;asfreq&#39; method:</span>
<span class="n">df_hourly</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s2">&quot;30Min&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dhi</th>
      <th>dni</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.576505</td>
      <td>0.0</td>
      <td>-0.764837</td>
    </tr>
    <tr>
      <th>2020-01-01 00:30:00-08:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-01-01 01:00:00-08:00</th>
      <td>-2.508561</td>
      <td>0.0</td>
      <td>-0.631080</td>
    </tr>
    <tr>
      <th>2020-01-01 01:30:00-08:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-01-01 02:00:00-08:00</th>
      <td>-1.943371</td>
      <td>0.0</td>
      <td>-0.374704</td>
    </tr>
    <tr>
      <th>2020-01-01 02:30:00-08:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-01-01 03:00:00-08:00</th>
      <td>-2.023108</td>
      <td>0.0</td>
      <td>-0.379228</td>
    </tr>
    <tr>
      <th>2020-01-01 03:30:00-08:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2020-01-01 04:00:00-08:00</th>
      <td>-1.683542</td>
      <td>0.0</td>
      <td>-0.013457</td>
    </tr>
    <tr>
      <th>2020-01-01 04:30:00-08:00</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Contrary to the case of down-sampling, both <em>asfreq</em> and <em>resample</em> provide similar results when up-sampling. However, <em>asfreq</em> provides additional functionalities to treat the new timestamps without data, i.e. NaN values.</p>
<p>By passing the argument <em>‘method’</em> with the string <em>‘backfill’</em> or <em>‘bfill’</em> uses the next valid observation to fill the NaN value (back filling). If instead, the string <em>‘pad’</em> or <em>‘ffill’</em> is given, the method assigns the last valid observation forward to the next valid (forward filling).</p>
<p>Let’s see the same example adding this argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Half-hourly up-sample with back filling function</span>
<span class="n">df_hourly</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s2">&quot;30Min&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfill&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dhi</th>
      <th>dni</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.576505</td>
      <td>0.0</td>
      <td>-0.764837</td>
    </tr>
    <tr>
      <th>2020-01-01 00:30:00-08:00</th>
      <td>-2.508561</td>
      <td>0.0</td>
      <td>-0.631080</td>
    </tr>
    <tr>
      <th>2020-01-01 01:00:00-08:00</th>
      <td>-2.508561</td>
      <td>0.0</td>
      <td>-0.631080</td>
    </tr>
    <tr>
      <th>2020-01-01 01:30:00-08:00</th>
      <td>-1.943371</td>
      <td>0.0</td>
      <td>-0.374704</td>
    </tr>
    <tr>
      <th>2020-01-01 02:00:00-08:00</th>
      <td>-1.943371</td>
      <td>0.0</td>
      <td>-0.374704</td>
    </tr>
    <tr>
      <th>2020-01-01 02:30:00-08:00</th>
      <td>-2.023108</td>
      <td>0.0</td>
      <td>-0.379228</td>
    </tr>
    <tr>
      <th>2020-01-01 03:00:00-08:00</th>
      <td>-2.023108</td>
      <td>0.0</td>
      <td>-0.379228</td>
    </tr>
    <tr>
      <th>2020-01-01 03:30:00-08:00</th>
      <td>-1.683542</td>
      <td>0.0</td>
      <td>-0.013457</td>
    </tr>
    <tr>
      <th>2020-01-01 04:00:00-08:00</th>
      <td>-1.683542</td>
      <td>0.0</td>
      <td>-0.013457</td>
    </tr>
    <tr>
      <th>2020-01-01 04:30:00-08:00</th>
      <td>-1.891827</td>
      <td>0.0</td>
      <td>-0.006960</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We see that the DataFrame now contains the next valid hourly value in the newly obtained half-hourly timestamps of the previous hour. It would take the previous valid hourly value if we used forward filling. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Half-hourly up-sample with forward-filling function</span>
<span class="n">df_hourly</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s2">&quot;30Min&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;ffill&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dhi</th>
      <th>dni</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.576505</td>
      <td>0.0</td>
      <td>-0.764837</td>
    </tr>
    <tr>
      <th>2020-01-01 00:30:00-08:00</th>
      <td>-2.576505</td>
      <td>0.0</td>
      <td>-0.764837</td>
    </tr>
    <tr>
      <th>2020-01-01 01:00:00-08:00</th>
      <td>-2.508561</td>
      <td>0.0</td>
      <td>-0.631080</td>
    </tr>
    <tr>
      <th>2020-01-01 01:30:00-08:00</th>
      <td>-2.508561</td>
      <td>0.0</td>
      <td>-0.631080</td>
    </tr>
    <tr>
      <th>2020-01-01 02:00:00-08:00</th>
      <td>-1.943371</td>
      <td>0.0</td>
      <td>-0.374704</td>
    </tr>
    <tr>
      <th>2020-01-01 02:30:00-08:00</th>
      <td>-1.943371</td>
      <td>0.0</td>
      <td>-0.374704</td>
    </tr>
    <tr>
      <th>2020-01-01 03:00:00-08:00</th>
      <td>-2.023108</td>
      <td>0.0</td>
      <td>-0.379228</td>
    </tr>
    <tr>
      <th>2020-01-01 03:30:00-08:00</th>
      <td>-2.023108</td>
      <td>0.0</td>
      <td>-0.379228</td>
    </tr>
    <tr>
      <th>2020-01-01 04:00:00-08:00</th>
      <td>-1.683542</td>
      <td>0.0</td>
      <td>-0.013457</td>
    </tr>
    <tr>
      <th>2020-01-01 04:30:00-08:00</th>
      <td>-1.683542</td>
      <td>0.0</td>
      <td>-0.013457</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The forward filling option provides the same value for o’clock and half past timestamps within the same hour. In addition to these two ways to complete the NaN values, the method <em>asfreq</em> can replace the NaN values with a constant. See below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Half-hourly up-sample filling the new timestamps with a constant</span>
<span class="n">df_hourly</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s2">&quot;30Min&quot;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dhi</th>
      <th>dni</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.576505</td>
      <td>0.0</td>
      <td>-0.764837</td>
    </tr>
    <tr>
      <th>2020-01-01 00:30:00-08:00</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2020-01-01 01:00:00-08:00</th>
      <td>-2.508561</td>
      <td>0.0</td>
      <td>-0.631080</td>
    </tr>
    <tr>
      <th>2020-01-01 01:30:00-08:00</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2020-01-01 02:00:00-08:00</th>
      <td>-1.943371</td>
      <td>0.0</td>
      <td>-0.374704</td>
    </tr>
    <tr>
      <th>2020-01-01 02:30:00-08:00</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2020-01-01 03:00:00-08:00</th>
      <td>-2.023108</td>
      <td>0.0</td>
      <td>-0.379228</td>
    </tr>
    <tr>
      <th>2020-01-01 03:30:00-08:00</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2020-01-01 04:00:00-08:00</th>
      <td>-1.683542</td>
      <td>0.0</td>
      <td>-0.013457</td>
    </tr>
    <tr>
      <th>2020-01-01 04:30:00-08:00</th>
      <td>0.000000</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The use of the methods <em>asfreq</em> or <em>resample</em> will depend on your dataset and the analysis you aim to undertake.</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="interpolating-time-series-data-a-id-timeseries-interpolation-a">
<h2>3 Interpolating time-series data<a id='timeseries_interpolation'></a><a class="headerlink" href="#interpolating-time-series-data-a-id-timeseries-interpolation-a" title="Permalink to this headline">¶</a></h2>
<p>When up-sampling the data series, it can happen that back-filling, forward-filling and constant replacement does not necessarily work for your analysis/application. An alternative approach is interpolating the replacing the NaN values with an interpolated result. Interpolation in Pandas DataFrames with <em>DatetimeIndex</em> is done with the <em>interpolate</em> method.</p>
<p>The mathematical interpolation method in <em>interpolate</em> is defined with the argument called <em>‘method’</em>. Pandas permits several interpolation methods, such as ‘linear’, ‘cubic’, ‘quadratic’, ‘spline’, ‘polynomial’ and others. All the interpolation options can be found in the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.interpolate.html">documentation</a> of the <em>interpolate</em> method.</p>
<p>Following the previous example, let’s implement interpolation in the missing values of the half-hourly timestamps using ‘linear’, ‘cubic’ and ‘polynomial’ methods:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Up-sample using the &#39;asfreq&#39; method</span>
<span class="n">df_30min</span> <span class="o">=</span> <span class="n">df_hourly</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s2">&quot;30Min&quot;</span><span class="p">)</span>
<span class="c1"># Interpolate missing values (NaN) with linear interpolation</span>
<span class="n">df_linear</span> <span class="o">=</span> <span class="n">df_30min</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span>
<span class="c1"># See the results:</span>
<span class="n">df_linear</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dhi</th>
      <th>dni</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.576505</td>
      <td>0.0</td>
      <td>-0.764837</td>
    </tr>
    <tr>
      <th>2020-01-01 00:30:00-08:00</th>
      <td>-2.542533</td>
      <td>0.0</td>
      <td>-0.697958</td>
    </tr>
    <tr>
      <th>2020-01-01 01:00:00-08:00</th>
      <td>-2.508561</td>
      <td>0.0</td>
      <td>-0.631080</td>
    </tr>
    <tr>
      <th>2020-01-01 01:30:00-08:00</th>
      <td>-2.225966</td>
      <td>0.0</td>
      <td>-0.502892</td>
    </tr>
    <tr>
      <th>2020-01-01 02:00:00-08:00</th>
      <td>-1.943371</td>
      <td>0.0</td>
      <td>-0.374704</td>
    </tr>
    <tr>
      <th>2020-01-01 02:30:00-08:00</th>
      <td>-1.983240</td>
      <td>0.0</td>
      <td>-0.376966</td>
    </tr>
    <tr>
      <th>2020-01-01 03:00:00-08:00</th>
      <td>-2.023108</td>
      <td>0.0</td>
      <td>-0.379228</td>
    </tr>
    <tr>
      <th>2020-01-01 03:30:00-08:00</th>
      <td>-1.853325</td>
      <td>0.0</td>
      <td>-0.196342</td>
    </tr>
    <tr>
      <th>2020-01-01 04:00:00-08:00</th>
      <td>-1.683542</td>
      <td>0.0</td>
      <td>-0.013457</td>
    </tr>
    <tr>
      <th>2020-01-01 04:30:00-08:00</th>
      <td>-1.787684</td>
      <td>0.0</td>
      <td>-0.010209</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Similarly, it can be implemented to other methods:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Interpolate missing values (NaN) with cubic interpolation</span>
<span class="n">df_cubic</span> <span class="o">=</span> <span class="n">df_30min</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;cubic&#39;</span><span class="p">)</span>
<span class="c1"># See the results:</span>
<span class="n">df_cubic</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dhi</th>
      <th>dni</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.576505</td>
      <td>0.000000</td>
      <td>-0.764837</td>
    </tr>
    <tr>
      <th>2020-01-01 00:30:00-08:00</th>
      <td>-2.708668</td>
      <td>0.015477</td>
      <td>-0.754314</td>
    </tr>
    <tr>
      <th>2020-01-01 01:00:00-08:00</th>
      <td>-2.508561</td>
      <td>0.000000</td>
      <td>-0.631080</td>
    </tr>
    <tr>
      <th>2020-01-01 01:30:00-08:00</th>
      <td>-2.184142</td>
      <td>-0.015477</td>
      <td>-0.477191</td>
    </tr>
    <tr>
      <th>2020-01-01 02:00:00-08:00</th>
      <td>-1.943371</td>
      <td>0.000000</td>
      <td>-0.374704</td>
    </tr>
    <tr>
      <th>2020-01-01 02:30:00-08:00</th>
      <td>-1.929019</td>
      <td>0.046430</td>
      <td>-0.371559</td>
    </tr>
    <tr>
      <th>2020-01-01 03:00:00-08:00</th>
      <td>-2.023108</td>
      <td>0.000000</td>
      <td>-0.379228</td>
    </tr>
    <tr>
      <th>2020-01-01 03:30:00-08:00</th>
      <td>-2.027425</td>
      <td>-0.170243</td>
      <td>-0.284694</td>
    </tr>
    <tr>
      <th>2020-01-01 04:00:00-08:00</th>
      <td>-1.683542</td>
      <td>0.000000</td>
      <td>-0.013457</td>
    </tr>
    <tr>
      <th>2020-01-01 04:30:00-08:00</th>
      <td>-1.097302</td>
      <td>0.634542</td>
      <td>0.333660</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>With polynomial interpolation, the degree or order of the polynomial function needs to be defined as an argument:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Interpolate missing values (NaN) with polynomial interpolation</span>
<span class="n">df_polynomial</span> <span class="o">=</span> <span class="n">df_30min</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;polynomial&#39;</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># See the results:</span>
<span class="n">df_polynomial</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ghi</th>
      <th>dhi</th>
      <th>dni</th>
    </tr>
    <tr>
      <th>datetime</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-01 00:00:00-08:00</th>
      <td>-2.576505</td>
      <td>0.000000</td>
      <td>-0.764837</td>
    </tr>
    <tr>
      <th>2020-01-01 00:30:00-08:00</th>
      <td>-1.992626</td>
      <td>0.512587</td>
      <td>0.655667</td>
    </tr>
    <tr>
      <th>2020-01-01 01:00:00-08:00</th>
      <td>-2.508561</td>
      <td>0.000000</td>
      <td>-0.631080</td>
    </tr>
    <tr>
      <th>2020-01-01 01:30:00-08:00</th>
      <td>-2.485236</td>
      <td>-0.214189</td>
      <td>-1.068238</td>
    </tr>
    <tr>
      <th>2020-01-01 02:00:00-08:00</th>
      <td>-1.943371</td>
      <td>0.000000</td>
      <td>-0.374704</td>
    </tr>
    <tr>
      <th>2020-01-01 02:30:00-08:00</th>
      <td>-1.619687</td>
      <td>0.201377</td>
      <td>0.199990</td>
    </tr>
    <tr>
      <th>2020-01-01 03:00:00-08:00</th>
      <td>-2.023108</td>
      <td>0.000000</td>
      <td>-0.379228</td>
    </tr>
    <tr>
      <th>2020-01-01 03:30:00-08:00</th>
      <td>-2.535919</td>
      <td>-0.346026</td>
      <td>-1.263387</td>
    </tr>
    <tr>
      <th>2020-01-01 04:00:00-08:00</th>
      <td>-1.683542</td>
      <td>0.000000</td>
      <td>-0.013457</td>
    </tr>
    <tr>
      <th>2020-01-01 04:30:00-08:00</th>
      <td>-0.233498</td>
      <td>0.762150</td>
      <td>2.341007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The interpolation of NaN values when up-sampling time-series data can help overcome the issues of using back or forward filling, specially if you aim to up-sample at higher frequencies than the example shown (e.g. 1-hour to 15-minute resolution series). The mathematical methods available for interpolation within Pandas are diverse and cover beyond the most common interpolation functions.</p>
</div>
<div class="section" id="visualizing-time-series-data-a-id-timeseries-visualization-a">
<h2>4 Visualizing time-series data<a id='timeseries_visualization'></a><a class="headerlink" href="#visualizing-time-series-data-a-id-timeseries-visualization-a" title="Permalink to this headline">¶</a></h2>
<p>It is often useful to visualize the data to grasp insighs and observe trends about the data. This section shows few examples to visualize time-series data.</p>
<div class="section" id="plotting-a-time-series-for-a-day-of-interest">
<h3>4.1 Plotting a time-series for a day of interest<a class="headerlink" href="#plotting-a-time-series-for-a-day-of-interest" title="Permalink to this headline">¶</a></h3>
<p>Below there is an example to visualize a single day of interest. With DataFrames using <em>DatetimeIndex</em> it is easy to select a particular day and Pandas interacts with Matplotlib.Pyplot library to plot straight-away.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting GHI for a given day in the time-series</span>
<span class="n">df_1min</span><span class="p">[</span><span class="s1">&#39;2020-06-01&#39;</span><span class="p">][</span><span class="s1">&#39;ghi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GHI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Irradiance [W/m$^2$]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Local Time [HH:MM]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># Not needed in Jupyter Notebooks but usually required in other IDEs.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/manipulating_time_series_57_0.png" src="../_images/manipulating_time_series_57_0.png" />
</div>
</div>
<p>We can visualize the effect of using average (<em>resample</em>) vs. instantaneous (<em>asfreq</em>) measurements when down-sampling our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plotting GHI for a given day in the time-series</span>
<span class="n">df_1min</span><span class="p">[</span><span class="s1">&#39;2020-06-01&#39;</span><span class="p">][</span><span class="s1">&#39;ghi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;1-min data&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span> <span class="c1"># Reference data</span>
<span class="n">df_1min</span><span class="o">.</span><span class="n">asfreq</span><span class="p">(</span><span class="s1">&#39;30Min&#39;</span><span class="p">)[</span><span class="s1">&#39;2020-06-01&#39;</span><span class="p">][</span><span class="s1">&#39;ghi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;30-min instant.&#39;</span><span class="p">)</span> <span class="c1"># Instantaneous 30-min values</span>
<span class="n">df_1min</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;30Min&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="s1">&#39;2020-06-01&#39;</span><span class="p">][</span><span class="s1">&#39;ghi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;30-min average&#39;</span><span class="p">)</span> <span class="c1"># Average 30-min values</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Average vs. Actual GHI Measurements&#39;</span><span class="p">)</span> <span class="c1"># title of the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Irradiance [W/m$^2$]&#39;</span><span class="p">)</span> <span class="c1"># y-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Local Time [HH:MM]&#39;</span><span class="p">)</span> <span class="c1"># x-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span> <span class="c1"># insert legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> <span class="c1"># Not needed in Jupyter Notebook but usually required in other IDEs.</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/manipulating_time_series_59_0.png" src="../_images/manipulating_time_series_59_0.png" />
</div>
</div>
</div>
<div class="section" id="plotting-a-time-series-for-a-few-consecutive-days-of-interest">
<h3>4.2 Plotting a time-series for a few consecutive days of interest<a class="headerlink" href="#plotting-a-time-series-for-a-few-consecutive-days-of-interest" title="Permalink to this headline">¶</a></h3>
<p>Below there is an example to visualize a few consecutive days (e.g. 5 days) of interest. By using [‘start date’]:[‘end date’] it is possible to select time ranges easily with a DataFrame having a <em>DatetimeIndex</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Variables to plot</span>
<span class="nb">vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ghi&#39;</span><span class="p">,</span> <span class="s1">&#39;dni&#39;</span><span class="p">,</span> <span class="s1">&#39;dhi&#39;</span><span class="p">]</span> 
<span class="c1"># Create 3 subplots, with shared X and Y axis</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="c1"># Add title to the plot</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Average Hourly Solar Radiation Observations&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_1min</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1H&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="s1">&#39;2020-06-01&#39;</span><span class="p">:</span><span class="s1">&#39;2020-06-05&#39;</span><span class="p">][</span><span class="nb">vars</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Average&#39;</span><span class="p">)</span> <span class="c1"># Average hourly</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_1min</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1H&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()[</span><span class="s1">&#39;2020-06-01&#39;</span><span class="p">:</span><span class="s1">&#39;2020-06-05&#39;</span><span class="p">][</span><span class="nb">vars</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Maximum&#39;</span><span class="p">)</span> <span class="c1"># Max. hourly</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_1min</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1H&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">min</span><span class="p">()[</span><span class="s1">&#39;2020-06-01&#39;</span><span class="p">:</span><span class="s1">&#39;2020-06-05&#39;</span><span class="p">][</span><span class="nb">vars</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Minimum&#39;</span><span class="p">)</span> <span class="c1"># Min. hourly</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span> <span class="c1"># Title for each subplot</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span> <span class="c1"># Adjust the white space between the subplots titles</span>
<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Irradiance [W/m$^2$]&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="c1"># Common Y Axis</span>
<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.51</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="s1">&#39;Local Time&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span> <span class="c1"># Common X Axis</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># Legend for the last subplot or &#39;axs[i].legend()&#39; in the loop to a legend to each.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/manipulating_time_series_61_0.png" src="../_images/manipulating_time_series_61_0.png" />
</div>
</div>
</div>
<div class="section" id="plotting-a-time-series-for-a-few-non-consecutive-days-of-interest">
<h3>4.3 Plotting a time-series for a few non-consecutive days of interest<a class="headerlink" href="#plotting-a-time-series-for-a-few-non-consecutive-days-of-interest" title="Permalink to this headline">¶</a></h3>
<p>Below there is an example to visualize a few non-consecutive days of interest, which could be the case when we would like to observe several days scattered throughout the year a single plot. In order to do this, we need to select the day of interest from the DataFrame and then reset its <em>DatetimeIndex</em>. For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of days of interest</span>
<span class="n">days</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-03-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-06-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2020-09-01&#39;</span><span class="p">]</span>
<span class="c1"># Iterate over the days and plot each of them</span>
<span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">days</span><span class="p">:</span> 
    <span class="n">df_day</span> <span class="o">=</span> <span class="n">df_1min</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;1H&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()[</span><span class="n">day</span><span class="p">][</span><span class="s1">&#39;ghi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>  <span class="c1"># average hourly of GHI for current day</span>
    <span class="n">df_day</span> <span class="o">=</span> <span class="n">df_day</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># reset its Index to numeric (i.e. 0,1,2,3...)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df_day</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">day</span><span class="p">)</span> <span class="c1"># plot the current day</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Average Hourly GHI Measurements for Days of Interest&#39;</span><span class="p">)</span> <span class="c1"># title of the figure</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span> <span class="c1"># set labels positions and names</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Irradiance [W/m$^2$]&#39;</span><span class="p">)</span> <span class="c1"># y-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Local Time&#39;</span><span class="p">)</span> <span class="c1"># x-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span> <span class="c1"># insert legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/manipulating_time_series_63_0.png" src="../_images/manipulating_time_series_63_0.png" />
</div>
</div>
</div>
<div class="section" id="daily-insolation-throughout-the-year">
<h3>4.4 Daily insolation throughout the year<a class="headerlink" href="#daily-insolation-throughout-the-year" title="Permalink to this headline">¶</a></h3>
<p>With time-series data, the hourly/daily/monthly insolation (i.e. the sum of accumulated energy) can also be analysed throughout the year with time-series data. For example, below an example to visualize the daily insolation is shown:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the daily insolation expressed in kWh·sqm from GHI measurements</span>
<span class="n">daily_energy</span> <span class="o">=</span> <span class="p">(</span><span class="n">df_1min</span><span class="p">[</span><span class="s1">&#39;ghi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s2">&quot;1D&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="p">))</span><span class="o">/</span><span class="mi">1000</span> <span class="c1"># selecting only GHI returns a Pandas Series</span>

<span class="c1"># Create time-series plot</span>
<span class="n">daily_energy</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="n">legend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># plot timeseries </span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time-series of Daily Insolation&#39;</span><span class="p">)</span>  <span class="c1"># add title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy [kWh/m$^2$]&#39;</span><span class="p">)</span> <span class="c1"># add Y-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span> <span class="c1"># add X-axis label</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/manipulating_time_series_65_0.png" src="../_images/manipulating_time_series_65_0.png" />
</div>
</div>
<p>Time-series data can also be visualized in other ways, for instance, as a heat map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prepare the data for heat map of hourly insolation</span>
<span class="n">energy_array</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span> <span class="c1"># empty DataFrame for the results</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span> <span class="c1"># iterate over months</span>
    <span class="c1"># select the data in the month and eliminate the datetimeindex</span>
    <span class="n">df_month</span> <span class="o">=</span> <span class="n">daily_energy</span><span class="p">[</span><span class="n">daily_energy</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">month</span><span class="o">==</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 
    <span class="c1"># rename the column with the number of the month</span>
    <span class="n">df_month</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)]</span>
    <span class="c1"># Append results to the DataFrame</span>
    <span class="n">energy_array</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">energy_array</span><span class="p">,</span> <span class="n">df_month</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Transpose to have months in y-axis and days in x-axis</span>
<span class="n">energy_array</span> <span class="o">=</span> <span class="n">energy_array</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
<span class="c1"># Rename the columns of the days </span>
<span class="n">energy_array</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>

<span class="c1"># Plot heat map of daily insolation</span>
<span class="n">months</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Jan&#39;</span><span class="p">,</span> <span class="s1">&#39;Feb&#39;</span><span class="p">,</span> <span class="s1">&#39;Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;Apr&#39;</span><span class="p">,</span> <span class="s1">&#39;May&#39;</span><span class="p">,</span> <span class="s1">&#39;Jun&#39;</span><span class="p">,</span> <span class="c1"># month labels</span>
          <span class="s1">&#39;Jul&#39;</span><span class="p">,</span> <span class="s1">&#39;Aug&#39;</span><span class="p">,</span> <span class="s1">&#39;Sep&#39;</span><span class="p">,</span> <span class="s1">&#39;Oct&#39;</span><span class="p">,</span> <span class="s1">&#39;Nov&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">energy_array</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;CMRmap&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="c1"># plot heatmap with Seaborn (sns) library </span>
                <span class="n">xticklabels</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">annot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;Daily Energy [kWh/m$^2$]&#39;</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Heat Map of Daily Insolation&#39;</span><span class="p">)</span> <span class="c1"># add title</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">months</span><span class="p">,</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># add the months as tick-labels for the y-axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xticklabels</span><span class="p">(),</span><span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># add the days as tick-labels for the x-axis</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Day of the Month&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/manipulating_time_series_67_0.png" src="../_images/manipulating_time_series_67_0.png" />
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-summary">
<h2>Section summary<a class="headerlink" href="#section-summary" title="Permalink to this headline">¶</a></h2>
<p>This section has shown how to build and work with a time-series in Python with multiple examples: <br></p>
<ul class="simple">
<li><p>We have seen how to prepare a DataFrame with <em>DatatimeIndex</em> to be used as a time-series when the timestamps are given in multiple formats in the temporal data and local/UTC time. <br></p></li>
<li><p>Changes in the temporal resolution of the data can be applied by down and up-sampling the data and the differences between 2 available methods (<em>asfreq</em> and <em>resample</em>) have been shown with examples and different sampling frequencies. <br></p></li>
<li><p>The interpolation of missing data in time-series can be used to up-sample the resolution of the data and examples with some methods have been shown. <br></p></li>
<li><p>Finally, several ideas to visualize data have been presented. <br></p></li>
</ul>
<p>Overall, the possibilities with time-series of solar resource are many. The most useful and suitable analysis and visualizations will be determined by the application and scope of the study.</p>
</div>
<hr class="docutils" />
<div class="section" id="references-a-id-references-a">
<h2>References<a id='references'></a><a class="headerlink" href="#references-a-id-references-a" title="Permalink to this headline">¶</a></h2>
<p>Andreas, A.; Stoffel, T.; (2006). University of Nevada (UNLV):
Las Vegas, Nevada (Data); NREL Report No. DA-5500-56509.
<a class="reference external" href="http://dx.doi.org/10.5439/1052548">http://dx.doi.org/10.5439/1052548</a></p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="solar_radiation_modeling.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Solar Radiation Modelling</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="solar_resource_data_overview.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Overview</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>